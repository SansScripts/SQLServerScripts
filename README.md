# SQLServerScripts - SQL Server DDL Generator

A Java application that connects to SQL Server databases and generates DDL (CREATE statements) for specified tables. The program can display the DDL directly in the console or save it to a structured directory for version control and deployment.

## Features

### Connection Management
- **Database Configuration**: Hostname, port (default: 1433), instance name, database name
- **Authentication**: SQL Server username/password authentication
- **Schema Selection**: Target specific schema (default: dbo)
- **Connection Validation**: Robust error handling with detailed connection feedback

### DDL Generation
- **Table Existence Validation**: Verifies table exists before scripting
- **Complete CREATE Statements**: Full table definition with:
  - Column names, data types, and constraints
  - NOT NULL constraints and DEFAULT values
  - IDENTITY columns and Primary Key constraints
- **Index Generation**: Creates all non-primary key indexes (unique and regular)
- **Foreign Key Constraints**: Generates ALTER TABLE statements for foreign keys
- **Header Comments**: Timestamped comments with table and generation info

### Output Options
- **Console Display**: View DDL directly in terminal with formatted output
- **File Export**: Save to structured directory with timestamped filenames
- **Multiple Tables**: Script multiple tables in a single session

### Directory Structure (Created on Demand)
```
SQLServerScripts/
├── scripts/              # Created when first saving
│   └── tables/           # Created when first table is saved
│       ├── customers_20250725_163045.sql
│       └── orders_20250725_163102.sql
└── (future: procedures/, functions/, views/)
```

## Requirements

- **Java**: JDK 11 or higher
- **SQL Server JDBC Driver**: mssql-jdbc-12.8.1.jre11.jar (included)
- **SQL Server**: Any version with accessible system catalogs

## Usage

### Basic Usage
```bash
java -cp .:mssql-jdbc-12.8.1.jre11.jar SQLServerScripts
```

### Interactive Workflow
1. **Connection Setup**:
   - Hostname (default: localhost)
   - Port (default: 1433)
   - Instance name (optional)
   - Database name (required)
   - Username (required)
   - Password (required)
   - Schema (default: dbo)

2. **Table Scripting**:
   - Enter table name to script
   - Choose output option:
     - Option 1: Display in console
     - Option 2: Save to file
   - Option to script additional tables

### Example Session
```
=== SQLServerScripts - SQL Server DDL Generator ===
Generate CREATE statements for SQL Server database objects

Enter SQL Server connection details:

Server hostname/IP [localhost]: 
Port [1433]: 
Instance name (optional, press enter to skip): 
Database name (required): myapp_db
Username (required): sa
Password (required): mypassword
Schema [dbo]: 

Connecting to: jdbc:sqlserver://localhost:1433;databaseName=myapp_db
Schema: dbo
====================================================
✓ Successfully connected to SQL Server database!

===================================================
Enter table name to script: customers

Output options:
1. Display DDL in console only
2. Save DDL to file
Choose option (1 or 2): 2

✓ Created scripts directory
✓ Created tables directory
✓ DDL saved to: /Users/hi/Documents/SQLServerScripts/scripts/tables/customers_20250725_163045.sql
  File size: 1247 bytes

Script another table? (y/n): n

✓ SQLServerScripts session completed successfully!
```

## Generated DDL Example

```sql
-- DDL for table: dbo.customers
-- Generated by SQLServerScripts on 2025-07-25 16:30:45

CREATE TABLE [dbo].[customers] (
    [customer_id] int IDENTITY(1,1) NOT NULL,
    [name] nvarchar(50) NOT NULL,
    [email] nvarchar(100) NULL,
    [created_at] datetime NOT NULL DEFAULT (getdate()),
    CONSTRAINT [PK_customers] PRIMARY KEY CLUSTERED ([customer_id])
);

-- Indexes
CREATE UNIQUE INDEX [IX_customers_email] ON [dbo].[customers] ([email]);
CREATE INDEX [IX_customers_created_at] ON [dbo].[customers] ([created_at]);

-- Foreign Key Constraints
ALTER TABLE [dbo].[customers] ADD CONSTRAINT [FK_customers_orders] 
  FOREIGN KEY ([customer_id]) REFERENCES [dbo].[orders] ([customer_id]);
```

## SQL Server Data Type Support

The application properly handles all SQL Server data types:
- **Numeric**: int, bigint, decimal, numeric, float, real, money, smallmoney
- **String**: varchar, nvarchar, char, nchar, text, ntext
- **Date/Time**: datetime, datetime2, smalldatetime, date, time, datetimeoffset
- **Binary**: binary, varbinary, image
- **Other**: bit, uniqueidentifier, xml, geography, geometry

## Architecture 6 Extensibility

### Current Implementation
- **Table Scripting**: Complete DDL generation for tables
- **Modular Design**: Separate methods for different DDL components
- **Directory Management**: On-demand creation of script directories

### Planned Extensions
- **Views**: CREATE VIEW statements
- **Functions**: CREATE FUNCTION statements  
- **Procedures**: CREATE PROCEDURE statements
- **Triggers**: CREATE TRIGGER statements
- **Sequences**: CREATE SEQUENCE statements
- **Full Schema**: Script entire schema or database
- **Multiple Schemas**: Cross-schema scripting support

### Extensible Structure
```java
// Future method signatures:
generateViewDDL(conn, viewName, schema)
generateFunctionDDL(conn, functionName, schema)  
generateProcedureDDL(conn, procedureName, schema)
generateSchemaDDL(conn, schemaName)
generateFullInstanceDDL(conn)
```

## Error Handling

The application provides comprehensive error handling:
- **Connection Issues**: Clear database connection error messages
- **Authentication Failures**: Specific credential validation errors
- **Missing Objects**: Table existence validation with helpful messages
- **Permission Issues**: SQL permission errors with context
- **File System**: Directory creation and file writing error handling

## Output File Naming

Generated files follow this pattern:
- **Format**: `{tablename}_{timestamp}.sql`
- **Example**: `customers_20250725_163045.sql`
- **Location**: `scripts/tables/`
- **Timestamp**: YYYYMMDD_HHMMSS format

## Troubleshooting

### Common Issues

1. **Connection refused**: 
   - Ensure SQL Server is running
   - Verify hostname, port, and instance name
   - Check firewall settings

2. **Authentication failed**:
   - Verify username/password
   - Check if SQL Server Authentication is enabled
   - Ensure user has database access

3. **Table not found**:
   - Verify table name spelling
   - Check if table exists in specified schema
   - Ensure user has SELECT permissions

4. **Permission denied**:
   - User needs SELECT access to system catalogs
   - Grant usage on schema if necessary

## Related Projects

- **PostScripts**: PostgreSQL DDL generator
- **SQLServerConnect**: SQL Server database schema inspector
- All projects use consistent interfaces and output formats

## File Structure

```
SQLServerScripts/
├── SQLServerScripts.java          # Main application
├── SQLServerScripts.class         # Compiled main class
├── ConnectionInfo.class           # Connection data structure
├── ScriptRequest.class            # Request data structure
├── mssql-jdbc-12.8.1.jre11.jar  # SQL Server JDBC driver
└── README.md                      # This documentation
```

## License

Educational/Development use. JDBC driver license applies separately.
